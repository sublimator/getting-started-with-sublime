<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Sublime Package Concepts</title>
    <link rel="stylesheet" type="text/css" href="css/styles.css"/>
</head>

<body>
    <div id="inner">
        <h1>Sublime Package Concepts</h1>

        <div class="navigation">
            <a href="index.html">home</a> | <a href="concepts-commands.html">prev</a> | <a href="concepts-configuration.html">next</a>
        </div>


        <div id="toc">
            <h2>Table Of Contents</h2>
            <ul>
                <li><a href="#introduction">Introduction</a></li>
            </ul>
            <ul>
                <li><a href="#as-folder">As Folder</a></li>
                <li><a href="#packages-path-where">Packages Path. Where?</a></li>
                <li><a href="#as-zip">As Zip</a></li>
                <li><a href="#terms">Terms</a></li>
                <li><a href="#upgrade-rules">Package Upgrade Rules</a></li>
                
                
                <!-- <li><a href="#a-hint">Parting Hint</a></li> -->
                <!-- <li><a href="#upgrade-rules">Upgrade Rules</a></li> -->
            </ul>
            <ul>
                <!-- <li><a href="#comments">Quiz</a></li> -->
                <li><a href="#try-this">Try this</a></li>
                <li><a href="#comments">Comments</a></li>
            </ul>
        </div>

        <!-- <div id="introduction" class="section">
            <h2>Introduction</h2>
            <p>
                XXXXX
            </p>
        </div> -->

        <div id="quiz" class='section'>
            <h2>Introduction</h2>
            <p> 
                Sublime groups assets together into packages. 
                For example Sublime ships with a
                <q>Python</q> package containing syntax
                highlighting support and an assortment of snippets
                and various other package <q>assets</q>
            </p>
        </div>

        <div id="as-folder" class='section'>
            <h2>As Folder</h2>
            <p>
                A package is basically a just a folder placed on a special path where Sublime will look for them.
            </p>
        </div>

        <div id="where" class='section'>
            <h2>Packages Path. Where?</h2>
            
            <ul>
                <li>Typically %APPDATA%\Sublime Text\Packages</li>
                <li>However, can be anywhere with a portable installation of Sublime</li>
            </ul>
        </div>

        <div id="as-zip" class='section'>
            <h2>As Zip</h2>
            <p>

                A folder may be zipped up to create a package installer. 
                Sublime sets up file type associations with
                the extension <q>sublime-package</q>. 
            </p>
            <p>
                By double 
                clicking on a zipped up package Sublime will either
                create a new folder in the packages path or update an
                existing one following special upgrade rules
            </p>
            <p>
                The packages that come with a standard installation of Sublime
                are upgraded between versions via this mechanism.
            </p>
        </div>


        <div id="terms" class="section">
            <h2>Terms</h2>
            
            <p> 
                Open a console or your gui file manager of choice and 
                <strong>have a quick peek at the contents of any directories mentioned</strong>
            </p>

            <dl>
                <dt>Asset</dt>
                <dd>
                    A discrete resource such as
                    <ul>
                        <li>a snippet</li>
                        <li>a file containing bindings mapping commands to keyboard combinations</li>
                        <li>a python file containing a plugin command</li>
                        <li>a per file type options file</li>
                    </ul>
                </dd>
            
                <dt id="data-directory">Data Directory</dt>
                <dd>
                
                    The folder where Sublime stores the uncompressed <q>working versions</q> of package files and users
                    generally makes modifications.

                    <p>%APPDATA%/Sublime Text/Packages</p>
                </dd>

            
                <dt>Pristine Packages</dt>
                <dd>
                    Sublime stores pristine (untouched) copies of an xxxx.sublime-package for later
                    purpose of determining differences between packages on upgrades.
                        <p>%APPDATA%/SublimeText/Pristine Packages</p>
                </dd>
                
                <dt>Installed Packages</dt>
                <dd>
                    The folder where Sublime will place user installed `double-clicked` sublime-package files.

                    <p>%APPDATA%/Sublime Text/Installed Packages</p>
                </dd>

                <dt>Orphans</dt>
                <dd>
                    Orphans are files that were in the old version of a package but no longer
                    in the new version.
                </dd>
            </dl>                
        </div>
        
        <div id="upgrade-rules" class='section'>
            <h2>Package Upgrade Rules</h2>
            <p>For each asset there are <strong>3 versions</strong> used in the merge process</p>
            <ul>
                <li>The <q>working</q> version in the <q>Data Directory</q> ( possibly modified by the user) </li>
                <li>The <q>new</q> version stored in a sublime-package zip archive </li>
                <li>Tne <q>old</q> version inside an archive in <q>Pristine Packages</q> </li>
            </ul>
            
            <p>For each asset this is the upgrade logic </p>
            <ul>
                <li>It is compared for differences between the new and old versions </li>
                <li>If the asset is an orphan, no longer in the new zip, the working version will be deleted</li>
                <li>If an asset is newer the working version will be updated, <strong>silently overwriting user modifications!</strong></li>
            </ul>
            <div>
                <h3>WTF!?</h3>
                <p>Yeah, you guessed it. You should use version control and merge tools to manage user modifications.</p>
                <p>The package upgrade rules are in the process of being updated to take backups before overwriting user modifications</p>
                <p> <strong>UPDATE:</strong>
                    As of the 1.2 beta released in 
                    <a href="http://www.sublimetext.com/forum/viewtopic.php?f=2&amp;t=605#p2261">2009-09-22</a>
                    the user files will be backed up to a folder at <q>%APPDATA%/Sublime Text/Backup</q> which mirrors the directory
                    structure of the working versions Packages directory.
                </p>
            </div>
        </div>
        
        <div id="try-this" class='section'>
            <h2>Try this</h2>
            <ul>
                <li>Open the python console</li>
                <li>Type in and evaluate the following python</li>
                <li>
                    <pre>
import sublime

# Find the Data directory
print sublime.packagesPath()

# Find where user installed packages go
print sublime.installedPackagesPath()
                    </pre>
                </li>
            </ul>
        </div>        
        
        <!-- <div id="quiz" class='section'>
            <h2>Quiz</h2>
            <ul>
                <li>What is XXXX? </li>
                <li>XXXX?</li>
                <li>XXXX?</li>
            </ul>
        </div> -->

        <div id="comments" class='section'>
            <h2>Comments</h2>
            <div id="disqus_thread"></div>
            <script type="text/javascript" src="http://disqus.com/forums/sublimetext/embed.js"></script>
            <noscript>
                <a href="http://sublimetext.disqus.com/?url=ref">View the discussion thread.</a>
            </noscript>
            <a href="http://disqus.com" class="dsq-brlink">
                blog comments powered by
                <span class="logo-disqus">Disqus</span>
            </a>
        </div>
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-10239254-3");
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>